# ===============================
# DATABASE - PostgreSQL
# ===============================
spring.datasource.url=${SPRING_DATASOURCE_URL:jdbc:postgresql://localhost:5432/saude_db}
spring.datasource.driver-class-name=org.postgresql.Driver
spring.datasource.username=${SPRING_DATASOURCE_USERNAME:postgres}
spring.datasource.password=${SPRING_DATASOURCE_PASSWORD:YOUR_DATABASE_PASSWORD_HERE}

# ===============================
# JPA / HIBERNATE
# ===============================
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.hibernate.ddl-auto=${SPRING_JPA_HIBERNATE_DDL_AUTO:none}
spring.jpa.show-sql=${SPRING_JPA_SHOW_SQL:false}
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.jdbc.lob.non_contextual_creation=true
spring.jpa.properties.hibernate.jdbc.batch_size=50
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true
spring.jpa.properties.hibernate.jdbc.batch_versioned_data=true

spring.datasource.hikari.maximum-pool-size=${SPRING_DATASOURCE_HIKARI_MAXIMUM_POOL_SIZE:40}
spring.datasource.hikari.minimum-idle=${SPRING_DATASOURCE_HIKARI_MINIMUM_IDLE:10}
spring.datasource.hikari.connection-timeout=${SPRING_DATASOURCE_HIKARI_CONNECTION_TIMEOUT:30000}
spring.datasource.hikari.idle-timeout=${SPRING_DATASOURCE_HIKARI_IDLE_TIMEOUT:600000}
spring.datasource.hikari.max-lifetime=${SPRING_DATASOURCE_HIKARI_MAX_LIFETIME:1800000}
spring.datasource.hikari.leak-detection-threshold=${SPRING_DATASOURCE_HIKARI_LEAK_DETECTION_THRESHOLD:60000}
spring.datasource.hikari.pool-name=SaudeHikariPool

# ===============================
# FLYWAY MIGRATION
# ===============================
spring.flyway.enabled=${SPRING_FLYWAY_ENABLED:true}
spring.flyway.baseline-on-migrate=true
spring.flyway.locations=classpath:db/migration
spring.flyway.validate-on-migrate=${SPRING_FLYWAY_VALIDATE_ON_MIGRATE:false}

# ===============================
# SERVER
# ===============================
server.port=${SERVER_PORT:8080}
server.tomcat.max-threads=${SERVER_TOMCAT_MAX_THREADS:300}
server.tomcat.min-spare-threads=${SERVER_TOMCAT_MIN_SPARE_THREADS:50}
server.tomcat.accept-count=${SERVER_TOMCAT_ACCEPT_COUNT:200}
server.tomcat.max-connections=${SERVER_TOMCAT_MAX_CONNECTIONS:8192}
server.tomcat.connection-timeout=${SERVER_TOMCAT_CONNECTION_TIMEOUT:20000}
server.tomcat.keep-alive-timeout=${SERVER_TOMCAT_KEEP_ALIVE_TIMEOUT:60000}
server.tomcat.max-keep-alive-requests=${SERVER_TOMCAT_MAX_KEEP_ALIVE_REQUESTS:100}
server.http2.enabled=${SERVER_HTTP2_ENABLED:true}
server.compression.enabled=${SERVER_COMPRESSION_ENABLED:true}
server.compression.mime-types=text/html,text/xml,text/plain,text/css,text/javascript,application/javascript,application/json,application/xml

# ✅ SEGURANÇA: Configuração de Cookies Seguros
# SameSite=Strict: Evita ataques CSRF (Cross-Site Request Forgery)
# HttpOnly: Previne acesso JavaScript aos cookies (proteção contra XSS)
# Secure: Garante que cookies só sejam enviados via HTTPS (em produção)
server.servlet.session.cookie.same-site=strict
server.servlet.session.cookie.http-only=true
server.servlet.session.cookie.secure=${COOKIE_SECURE:false}
server.servlet.session.cookie.max-age=3600

# ===============================
# REDIS (DESABILITADO POR PADRAO)
# ===============================
#spring.redis.host=localhost
#spring.redis.port=6379
#spring.redis.timeout=2000ms
#spring.redis.database=0
#spring.redis.jedis.pool.max-active=20
#spring.redis.jedis.pool.max-idle=10
#spring.redis.jedis.pool.min-idle=5
#spring.redis.jedis.pool.max-wait=-1ms
management.health.redis.enabled=false

# ===============================
# JWT
# ===============================
# ⚠️ IMPORTANTE: Configure a variável de ambiente JWT_SECRET com um valor seguro
# Deve ser uma string base64 longa e complexa (mínimo 64 caracteres)
# Exemplo de geração: openssl rand -base64 64
jwt.secret=${JWT_SECRET}
jwt.expiration=${JWT_EXPIRATION:36800000}

# ===============================
# ACTUATOR
# ===============================
management.endpoints.web.exposure.include=health,info,metrics,prometheus,env,configprops,beans,caches,httptrace
management.endpoint.health.show-details=always
management.endpoint.health.show-components=always
management.endpoint.metrics.enabled=true
management.endpoint.prometheus.enabled=true
management.metrics.export.prometheus.enabled=true
management.info.env.enabled=true
management.info.java.enabled=true
management.info.os.enabled=true
management.health.db.enabled=true
management.health.diskspace.enabled=true

# ===============================
# LOGGING
# ===============================
logging.level.org.springframework.security=${LOGGING_SECURITY_LEVEL:INFO}
logging.level.com.sistemadesaude=${LOGGING_APP_LEVEL:INFO}
logging.level.org.hibernate.SQL=${LOGGING_HIBERNATE_SQL_LEVEL:WARN}
logging.level.org.flywaydb=${LOGGING_FLYWAY_LEVEL:INFO}
logging.level.org.springframework.boot.context.config=${LOGGING_BOOT_CONFIG_LEVEL:INFO}
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} - %msg%n
logging.pattern.file=%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n

# ===============================
# PROFILES
# ===============================
# Defina SPRING_PROFILES_ACTIVE no ambiente para selecionar o perfil correto

# ===============================
# BRANDING
# ===============================
app.brand.public-base-url=${APP_BRAND_PUBLIC_BASE_URL:/}
app.brand.logo-filename=Gemini_Generated_Image_n0g1kin0g1kin0g1.png
app.brand.org-nome=VITALIZA SAUDE

# ===============================
# STORAGE
# ===============================
app.storage.documentos.path=${APP_STORAGE_DOCUMENTOS_PATH:storage/documentos}

# ===============================
# INSTRUÇÕES DE USO
# ===============================
# 1. Copie este arquivo para application.properties
# 2. Configure as variáveis de ambiente necessárias:
#    - JWT_SECRET: Gere com: openssl rand -base64 64
#    - SPRING_DATASOURCE_PASSWORD: Senha do PostgreSQL
# 3. Nunca commite o arquivo application.properties original com secrets
